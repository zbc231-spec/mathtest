<!doctype html>
<html lang="zh-TW">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ‰‡å½¢é¢ç©æˆ–å‘¨é•·æ¸¬é©—</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="min-h-full bg-gradient-to-br from-blue-50 to-indigo-100">
  <div id="app" class="min-h-full p-6"></div>
  <script>
    const defaultConfig = {
      quiz_title: "æ‰‡å½¢é¢ç©æˆ–å‘¨é•·æ¸¬é©—",
      instruction_text: "è«‹è¼¸å…¥ä½ çš„è³‡è¨Šé–‹å§‹æ¸¬é©—",
      start_button_text: "é–‹å§‹ç·´ç¿’",
      submit_button_text: "æäº¤ç­”æ¡ˆ",
      restart_button_text: "é‡æ–°é–‹å§‹æ¸¬é©—",
      primary_color: "#3b82f6",
      secondary_color: "#ffffff",
      text_color: "#1e293b",
      button_color: "#8b5cf6",
      accent_color: "#10b981",
      font_family: "system-ui",
      font_size: 16
    };

    const allQuestions = [
      {type: "perimeter", angle: 30, diameter: 6, answer: "7.57", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 6 Ã· 2 = 3\nå¼§é•· = 2 Ã— 3.14 Ã— 3 Ã— (30 Ã· 360) = 1.57\nå‘¨é•· = 1.57 + 3 + 3 = 7.57"},
      {type: "perimeter", angle: 36, diameter: 50, answer: "65.7", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 50 Ã· 2 = 25\nå¼§é•· = 2 Ã— 3.14 Ã— 25 Ã— (36 Ã· 360) = 15.7\nå‘¨é•· = 15.7 + 25 + 25 = 65.7"},
      {type: "perimeter", angle: 40, diameter: 27, answer: "36.42", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 27 Ã· 2 = 13.5\nå¼§é•· = 2 Ã— 3.14 Ã— 13.5 Ã— (40 Ã· 360) = 9.42\nå‘¨é•· = 9.42 + 13.5 + 13.5 = 36.42"},
      {type: "perimeter", angle: 45, diameter: 8, answer: "11.14", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 8 Ã· 2 = 4\nå¼§é•· = 2 Ã— 3.14 Ã— 4 Ã— (45 Ã· 360) = 3.14\nå‘¨é•· = 3.14 + 4 + 4 = 11.14"},
      {type: "perimeter", angle: 45, diameter: 16, answer: "22.28", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 16 Ã· 2 = 8\nå¼§é•· = 2 Ã— 3.14 Ã— 8 Ã— (45 Ã· 360) = 6.28\nå‘¨é•· = 6.28 + 8 + 8 = 22.28"},
      {type: "perimeter", angle: 60, radius: 12, answer: "36.56", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 12 Ã— (60 Ã· 360) = 12.56\nå‘¨é•· = 12.56 + 12 + 12 = 36.56"},
      {type: "perimeter", angle: 60, diameter: 8, answer: "12.18", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 8 Ã· 2 = 4\nå¼§é•· = 2 Ã— 3.14 Ã— 4 Ã— (60 Ã· 360) = 4.18\nå‘¨é•· = 4.18 + 4 + 4 = 12.18"},
      {type: "perimeter", angle: 72, diameter: 25, answer: "40.7", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 25 Ã· 2 = 12.5\nå¼§é•· = 2 Ã— 3.14 Ã— 12.5 Ã— (72 Ã· 360) = 15.7\nå‘¨é•· = 15.7 + 12.5 + 12.5 = 40.7"},
      {type: "perimeter", angle: 80, radius: 9, answer: "30.56", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 9 Ã— (80 Ã· 360) = 12.56\nå‘¨é•· = 12.56 + 9 + 9 = 30.56"},
      {type: "perimeter", angle: 90, diameter: 16, answer: "28.56", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 16 Ã· 2 = 8\nå¼§é•· = 2 Ã— 3.14 Ã— 8 Ã— (90 Ã· 360) = 12.56\nå‘¨é•· = 12.56 + 8 + 8 = 28.56"},
      {type: "perimeter", angle: 120, radius: 15, answer: "61.4", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 15 Ã— (120 Ã· 360) = 31.4\nå‘¨é•· = 31.4 + 15 + 15 = 61.4"},
      {type: "perimeter", angle: 120, radius: 12, answer: "49.12", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 12 Ã— (120 Ã· 360) = 25.12\nå‘¨é•· = 25.12 + 12 + 12 = 49.12"},
      {type: "perimeter", angle: 135, radius: 4, answer: "17.42", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 4 Ã— (135 Ã· 360) = 9.42\nå‘¨é•· = 9.42 + 4 + 4 = 17.42"},
      {type: "perimeter", angle: 144, radius: 10, answer: "45.12", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 10 Ã— (144 Ã· 360) = 25.12\nå‘¨é•· = 25.12 + 10 + 10 = 45.12"},
      {type: "perimeter", angle: 150, radius: 24, answer: "110.8", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 24 Ã— (150 Ã· 360) = 62.8\nå‘¨é•· = 62.8 + 24 + 24 = 110.8"},
      {type: "perimeter", angle: 160, diameter: 14, answer: "33.53", solution: "å‘¨é•· = å¼§é•· + å…©æ¢æ¢åŠå¾‘\nåŠå¾‘ = 14 Ã· 2 = 7\nå¼§é•· = 2 Ã— 3.14 Ã— 7 Ã— (160 Ã· 360) = 19.53\nå‘¨é•· = 19.53 + 7 + 7 = 33.53"},
      {type: "perimeter", angle: 180, radius: 9, answer: "46.26", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 9 Ã— (180 Ã· 360) = 28.26\nå‘¨é•· = 28.26 + 9 + 9 = 46.26"},
      {type: "perimeter", angle: 180, diameter: 10, answer: "25.7", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 10 Ã· 2 = 5\nå¼§é•· = 2 Ã— 3.14 Ã— 5 Ã— (180 Ã· 360) = 15.7\nå‘¨é•· = 15.7 + 5 + 5 = 25.7"},
      {type: "perimeter", angle: 210, radius: 18, answer: "101.97", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 18 Ã— (210 Ã· 360) = 65.97\nå‘¨é•· = 65.97 + 18 + 18 = 101.97"},
      {type: "perimeter", angle: 240, radius: 6, answer: "37.12", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 6 Ã— (240 Ã· 360) = 25.12\nå‘¨é•· = 25.12 + 6 + 6 = 37.12"},
      {type: "perimeter", angle: 240, radius: 15, answer: "92.8", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 15 Ã— (240 Ã· 360) = 62.8\nå‘¨é•· = 62.8 + 15 + 15 = 92.8"},
      {type: "perimeter", angle: 270, diameter: 18, answer: "60.39", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 18 Ã· 2 = 9\nå¼§é•· = 2 Ã— 3.14 Ã— 9 Ã— (270 Ã· 360) = 42.39\nå‘¨é•· = 42.39 + 9 + 9 = 60.39"},
      {type: "perimeter", angle: 300, radius: 3, answer: "21.7", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 3 Ã— (300 Ã· 360) = 15.7\nå‘¨é•· = 15.7 + 3 + 3 = 21.7"},
      {type: "perimeter", angle: 315, diameter: 22, answer: "82.445", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nåŠå¾‘ = 22 Ã· 2 = 11\nå¼§é•· = 2 Ã— 3.14 Ã— 11 Ã— (315 Ã· 360) = 60.445\nå‘¨é•· = 60.445 + 11 + 11 = 82.445"},
      {type: "perimeter", angle: 330, radius: 15, answer: "116.35", solution: "å‘¨é•· = å¼§é•· + å…©æ¢åŠå¾‘\nå¼§é•· = 2 Ã— 3.14 Ã— 15 Ã— (330 Ã· 360) = 86.35\nå‘¨é•· = 86.35 + 15 + 15 = 116.35"},
      {type: "area", angle: 30, radius: 6, answer: "9.42", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 6Â² = 113.04\næ‰‡å½¢é¢ç© = 113.04 Ã— (30 Ã· 360) = 9.42"},
      {type: "area", angle: 36, radius: 5, answer: "7.85", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 5Â² = 78.5\næ‰‡å½¢é¢ç© = 78.5 Ã— (36 Ã· 360) = 7.85"},
      {type: "area", angle: 40, radius: 3, answer: "3.14", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 3Â² = 28.26\næ‰‡å½¢é¢ç© = 28.26 Ã— (40 Ã· 360) = 3.14"},
      {type: "area", angle: 45, radius: 10, answer: "39.25", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 10Â² = 314\næ‰‡å½¢é¢ç© = 314 Ã— (45 Ã· 360) = 39.25"},
      {type: "area", angle: 45, radius: 12, answer: "56.52", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 12Â² = 452.16\næ‰‡å½¢é¢ç© = 452.16 Ã— (45 Ã· 360) = 56.52"},
      {type: "area", angle: 60, radius: 30, answer: "471", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 30Â² = 2826\næ‰‡å½¢é¢ç© = 2826 Ã— (60 Ã· 360) = 471"},
      {type: "area", angle: 60, radius: 12, answer: "75.36", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 12Â² = 452.16\næ‰‡å½¢é¢ç© = 452.16 Ã— (60 Ã· 360) = 75.36"},
      {type: "area", angle: 72, radius: 10, answer: "62.8", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 10Â² = 314\næ‰‡å½¢é¢ç© = 314 Ã— (72 Ã· 360) = 62.8"},
      {type: "area", angle: 80, diameter: 12, answer: "25.12", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 12 Ã· 2 = 6\nåœ“é¢ç© = 3.14 Ã— 6Â² = 113.04\næ‰‡å½¢é¢ç© = 113.04 Ã— (80 Ã· 360) = 25.12"},
      {type: "area", angle: 90, radius: 20, answer: "314", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 20Â² = 1256\næ‰‡å½¢é¢ç© = 1256 Ã— (90 Ã· 360) = 314"},
      {type: "area", angle: 120, radius: 15, answer: "235.5", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 15Â² = 706.5\næ‰‡å½¢é¢ç© = 706.5 Ã— (120 Ã· 360) = 235.5"},
      {type: "area", angle: 120, diameter: 24, answer: "150.72", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 24 Ã· 2 = 12\nåœ“é¢ç© = 3.14 Ã— 12Â² = 452.16\næ‰‡å½¢é¢ç© = 452.16 Ã— (120 Ã· 360) = 150.72"},
      {type: "area", angle: 135, radius: 4, answer: "18.84", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 4Â² = 50.24\næ‰‡å½¢é¢ç© = 50.24 Ã— (135 Ã· 360) = 18.84"},
      {type: "area", angle: 144, diameter: 20, answer: "125.6", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 20 Ã· 2 = 10\nåœ“é¢ç© = 3.14 Ã— 10Â² = 314\næ‰‡å½¢é¢ç© = 314 Ã— (144 Ã· 360) = 125.6"},
      {type: "area", angle: 150, radius: 24, answer: "754", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 24Â² = 1808.64\næ‰‡å½¢é¢ç© = 1808.64 Ã— (150 Ã· 360) = 754"},
      {type: "area", angle: 160, diameter: 14, answer: "68.22", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 14 Ã· 2 = 7\næ‰‡å½¢é¢ç© = 3.14 Ã— 7Â² = 153.86\næ‰‡å½¢é¢ç© = 153.86 Ã— (160 Ã· 360) = 68.22"},
      {type: "area", angle: 180, diameter: 20, answer: "157", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 20 Ã· 2 = 10\nåœ“é¢ç© = 3.14 Ã— 10Â² = 314\næ‰‡å½¢é¢ç© = 314 Ã— (180 Ã· 360) = 157"},
      {type: "area", angle: 180, radius: 9, answer: "127.17", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 9Â² = 254.34\næ‰‡å½¢é¢ç© = 254.34 Ã— (180 Ã· 360) = 127.17"},
      {type: "area", angle: 180, diameter: 10, answer: "39.25", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 10 Ã· 2 = 5\nåœ“é¢ç© = 3.14 Ã— 5Â² = 78.5\næ‰‡å½¢é¢ç© = 78.5 Ã— (180 Ã· 360) = 39.25"},
      {type: "area", angle: 210, radius: 18, answer: "593.46", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 18Â² = 1017.36\næ‰‡å½¢é¢ç© = 1017.36 Ã— (210 Ã· 360) = 593.46"},
      {type: "area", angle: 240, radius: 6, answer: "75.36", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 6Â² = 113.04\næ‰‡å½¢é¢ç© = 113.04 Ã— (240 Ã· 360) = 75.36"},
      {type: "area", angle: 240, diameter: 30, answer: "471", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 30 Ã· 2 = 15\nåœ“é¢ç© = 3.14 Ã— 15Â² = 706.5\næ‰‡å½¢é¢ç© = 706.5 Ã— (240 Ã· 360) = 471"},
      {type: "area", angle: 270, radius: 20, answer: "942", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 20Â² = 1256\næ‰‡å½¢å½¢é¢ç© = 1256 Ã— (270 Ã· 360) = 942"},
      {type: "area", angle: 300, diameter: 24, answer: "376.8", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 24 Ã· 2 = 12\nåœ“é¢ç© = 3.14 Ã— 12Â² = 452.16\næ‰‡å½¢é¢ç© = 452.16 Ã— (300 Ã· 360) = 376.8"},
      {type: "area", angle: 315, diameter: 22, answer: "105.04", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåŠå¾‘ = 22 Ã· 2 = 11\nåœ“é¢ç© = 3.14 Ã— 11Â² = 379.94\næ‰‡å½¢é¢ç© = 379.94 Ã— (315 Ã· 360) = 105.04"},
      {type: "area", angle: 330, radius: 15, answer: "193.13", solution: "é¢ç© = åœ“é¢ç© Ã— (åœ“å¿ƒè§’ Ã· 360)\nåœ“é¢ç© = 3.14 Ã— 15Â² = 706.5\næ‰‡å½¢é¢ç© = 706.5 Ã— (330 Ã· 360) = 193.13"}
    ];

    let currentState = {
      stage: 'input',
      grade: '',
      classNumber: '',
      seatNumber: '',
      currentQuestionIndex: 0,
      userAnswers: [],
      dailyQuestions: [],
      todayDate: ''
    };

    function getTodayDate() {
      const today = new Date();
      return `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
    }

    function seedRandom(seed) {
      let state = seed;
      return function() {
        state = (state * 1103515245 + 12345) & 0x7fffffff;
        return state / 0x7fffffff;
      };
    }

    function generateDailyQuestions(dateString) {
      const seed = dateString.split('-').reduce((acc, val) => acc + parseInt(val), 0);
      const random = seedRandom(seed);
      
      const perimeterQuestions = allQuestions.filter(q => q.type === 'perimeter');
      const areaQuestions = allQuestions.filter(q => q.type === 'area');
      
      const shuffledPerimeter = [...perimeterQuestions].sort(() => random() - 0.5);
      const shuffledArea = [...areaQuestions].sort(() => random() - 0.5);
      
      const selected = [
        ...shuffledPerimeter.slice(0, 3),
        ...shuffledArea.slice(0, 3)
      ];
      
      return selected.sort(() => random() - 0.5);
    }

    function drawSector(angle, radius) {
      const size = 300;
      const center = size / 2;
      const scale = (size * 0.35) / Math.max(radius, 10);
      const r = radius * scale;
      
      const startAngle = -90;
      const endAngle = startAngle + angle;
      
      const startRad = (startAngle * Math.PI) / 180;
      const endRad = (endAngle * Math.PI) / 180;
      
      const x1 = center + r * Math.cos(startRad);
      const y1 = center + r * Math.sin(startRad);
      const x2 = center + r * Math.cos(endRad);
      const y2 = center + r * Math.sin(endRad);
      
      const largeArc = angle > 180 ? 1 : 0;
      
      return `
        <svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" class="mx-auto">
          <path d="M ${center} ${center} L ${x1} ${y1} A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2} Z" 
                fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
          <circle cx="${center}" cy="${center}" r="3" fill="#ef4444"/>
          <text x="${center}" y="${center - 5}" text-anchor="middle" font-size="12" fill="#1e293b">${angle}Â°</text>
        </svg>
      `;
    }

    function render() {
      const app = document.getElementById('app');
      const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;
      
      if (currentState.stage === 'input') {
        app.innerHTML = `
          <div class="max-w-2xl mx-auto">
            <div class="rounded-2xl shadow-xl p-8" style="background: ${config.secondary_color || defaultConfig.secondary_color}; font-family: ${customFont}, ${baseFontStack};">
              <div class="flex items-center justify-center gap-3 mb-6">
                <svg class="w-12 h-12" fill="none" stroke="${config.primary_color || defaultConfig.primary_color}" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                </svg>
                <h1 class="font-bold" style="font-size: ${baseSize * 2}px; color: ${config.text_color || defaultConfig.text_color};">${config.quiz_title || defaultConfig.quiz_title}</h1>
              </div>
              
              <div class="mb-6 p-4 rounded-lg" style="background: ${config.primary_color || defaultConfig.primary_color}15;">
                <div class="flex items-center gap-2 mb-2">
                  <svg class="w-5 h-5" fill="none" stroke="${config.primary_color || defaultConfig.primary_color}" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                  </svg>
                  <span class="font-semibold" style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">ä»Šå¤©æ¸¬é©—æ—¥æœŸï¼š${currentState.todayDate}</span>
                </div>
                <p style="font-size: ${baseSize * 0.85}px; color: ${config.text_color || defaultConfig.text_color};">ä½œç­”è«‹åŠ æ²¹</p>
              </div>
              
              <p class="mb-6 text-center" style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">${config.instruction_text || defaultConfig.instruction_text}</p>
              
              <div class="space-y-4">
                <div>
                  <label class="flex items-center gap-2 mb-2 font-medium" style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">
                    <svg class="w-5 h-5" fill="none" stroke="${config.button_color || defaultConfig.button_color}" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                    </svg>
                    å¹´ç´š
                  </label>
                  <input type="number" id="grade" min="5" max="6" placeholder="5å¹´ç´šè«‹å¡«5ï¼Œ6å¹´ç´šè«‹å¡«6" 
                         class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2"
                         style="font-size: ${baseSize}px; border-color: ${config.primary_color || defaultConfig.primary_color}30; font-family: ${customFont}, ${baseFontStack};">
                </div>
                
                <div>
                  <label class="flex items-center gap-2 mb-2 font-medium" style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">
                    <svg class="w-5 h-5" fill="none" stroke="${config.button_color || defaultConfig.button_color}" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    ç­ç´š
                  </label>
                  <input type="number" id="classNumber" min="1" placeholder="1ç­è«‹å¡«1ï¼Œ2ç­è«‹å¡«2ï¼Œä¾æ­¤é¡æ¨" 
                         class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2"
                         style="font-size: ${baseSize}px; border-color: ${config.primary_color || defaultConfig.primary_color}30; font-family: ${customFont}, ${baseFontStack};">
                </div>
                
                <div>
                  <label class="flex items-center gap-2 mb-2 font-medium" style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">
                    <svg class="w-5 h-5" fill="none" stroke="${config.button_color || defaultConfig.button_color}" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    åº§è™Ÿ
                  </label>
                  <input type="number" id="seatNumber" min="1" placeholder="1è™Ÿè«‹å¡«1ï¼Œ2è™Ÿè«‹å¡«2ï¼Œä¾æ­¤é¡æ¨" 
                         class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2"
                         style="font-size: ${baseSize}px; border-color: ${config.primary_color || defaultConfig.primary_color}30; font-family: ${customFont}, ${baseFontStack};">
                </div>
              </div>
              
              <button id="startBtn" class="w-full mt-6 px-6 py-4 rounded-lg font-bold text-white shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                      style="background: ${config.button_color || defaultConfig.button_color}; font-size: ${baseSize * 1.1}px; font-family: ${customFont}, ${baseFontStack};">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                ${config.start_button_text || defaultConfig.start_button_text}
              </button>
            </div>
          </div>
        `;
        
        document.getElementById('startBtn').addEventListener('click', startQuiz);
      } else if (currentState.stage === 'quiz') {
        const question = currentState.dailyQuestions[currentState.currentQuestionIndex];
        const questionType = question.type === 'perimeter' ? 'å‘¨é•·' : 'é¢ç©';
        const dimensionText = question.radius ? `åŠå¾‘ ${question.radius}` : `ç›´å¾‘ ${question.diameter}`;
        
        app.innerHTML = `
          <div class="max-w-2xl mx-auto">
            <div class="rounded-2xl shadow-xl p-8" style="background: ${config.secondary_color || defaultConfig.secondary_color}; font-family: ${customFont}, ${baseFontStack};">
              <div class="mb-6 flex justify-between items-center">
                <div class="flex items-center gap-2">
                  <svg class="w-6 h-6" fill="none" stroke="${config.accent_color || defaultConfig.accent_color}" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  <span class="font-bold" style="font-size: ${baseSize * 1.2}px; color: ${config.accent_color || defaultConfig.accent_color};">é¡Œç›® ${currentState.currentQuestionIndex + 1}/6</span>
                </div>
                <div class="text-right" style="font-size: ${baseSize * 0.85}px; color: ${config.text_color || defaultConfig.text_color};">
                  <div class="flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="${config.text_color || defaultConfig.text_color}" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    <span>${currentState.grade}å¹´${currentState.classNumber}ç­ ${currentState.seatNumber}è™Ÿ</span>
                  </div>
                </div>
              </div>
              
              <div class="mb-6 p-6 rounded-xl" style="background: ${config.primary_color || defaultConfig.primary_color}10;">
                ${drawSector(question.angle, question.radius || question.diameter / 2)}
                <div class="mt-4 text-center space-y-2">
                  <p class="font-bold" style="font-size: ${baseSize * 1.3}px; color: ${config.text_color || defaultConfig.text_color};">åœ“å¿ƒè§’ï¼š${question.angle}åº¦</p>
                  <p class="font-semibold" style="font-size: ${baseSize * 1.1}px; color: ${config.text_color || defaultConfig.text_color};">${dimensionText}</p>
                  <p class="font-bold" style="font-size: ${baseSize * 1.5}px; color: ${config.button_color || defaultConfig.button_color};">æ±‚${questionType}</p>
                </div>
              </div>
              
              <div class="mb-6">
                <label class="block mb-3 font-semibold" style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">ä½ çš„ç­”æ¡ˆï¼š</label>
                <input type="number" step="0.01" id="answerInput" placeholder="è«‹è¼¸å…¥ç­”æ¡ˆ" 
                       class="w-full px-4 py-4 border-2 rounded-lg focus:outline-none focus:ring-2 text-center text-xl"
                       style="font-size: ${baseSize * 1.2}px; border-color: ${config.primary_color || defaultConfig.primary_color}; font-family: ${customFont}, ${baseFontStack};">
              </div>
              
              <button id="submitBtn" class="w-full px-6 py-4 rounded-lg font-bold text-white shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                      style="background: ${config.button_color || defaultConfig.button_color}; font-size: ${baseSize * 1.1}px; font-family: ${customFont}, ${baseFontStack};">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                ${config.submit_button_text || defaultConfig.submit_button_text}
              </button>
            </div>
          </div>
        `;
        
        document.getElementById('submitBtn').addEventListener('click', submitAnswer);
      } else if (currentState.stage === 'results') {
        const score = currentState.userAnswers.filter((ans, idx) => 
          parseFloat(ans) === parseFloat(currentState.dailyQuestions[idx].answer)
        ).length;
        const percentage = Math.round((score / 6) * 100);
        
        app.innerHTML = `
          <div class="max-w-4xl mx-auto">
            <div class="rounded-2xl shadow-xl p-8" style="background: ${config.secondary_color || defaultConfig.secondary_color}; font-family: ${customFont}, ${baseFontStack};">
              <div class="text-center mb-8">
                <svg class="w-20 h-20 mx-auto mb-4" fill="none" stroke="${config.accent_color || defaultConfig.accent_color}" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                </svg>
                <h2 class="font-bold mb-2" style="font-size: ${baseSize * 2}px; color: ${config.text_color || defaultConfig.text_color};">æ¸¬é©—å®Œæˆï¼</h2>
                <p class="font-bold" style="font-size: ${baseSize * 1.8}px; color: ${config.button_color || defaultConfig.button_color};">(å¾—åˆ†ï¼š${score})</p>
              </div>
              
              <div class="space-y-6">
                ${currentState.dailyQuestions.map((q, idx) => {
                  const isCorrect = parseFloat(currentState.userAnswers[idx]) === parseFloat(q.answer);
                  const questionType = q.type === 'perimeter' ? 'å‘¨é•·' : 'é¢ç©';
                  const dimensionText = q.radius ? `åŠå¾‘ ${q.radius}` : `ç›´å¾‘ ${q.diameter}`;
                  
                  return `
                    <div class="p-6 rounded-xl border-2" style="border-color: ${isCorrect ? config.accent_color || defaultConfig.accent_color : '#ef4444'}; background: ${config.secondary_color || defaultConfig.secondary_color};">
                      <div class="flex items-start gap-4">
                        <div class="flex-shrink-0">
                          ${isCorrect ? 
                            `<svg class="w-8 h-8" fill="none" stroke="${config.accent_color || defaultConfig.accent_color}" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>` :
                            `<svg class="w-8 h-8" fill="none" stroke="#ef4444" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>`
                          }
                        </div>
                        <div class="flex-1">
                          <h3 class="font-bold mb-2" style="font-size: ${baseSize * 1.2}px; color: ${config.text_color || defaultConfig.text_color};">ç¬¬ ${idx + 1} é¡Œ</h3>
                          <p style="font-size: ${baseSize}px; color: ${config.text_color || defaultConfig.text_color};">åœ“å¿ƒè§’ ${q.angle}åº¦ï¼Œ${dimensionText}ï¼Œæ±‚${questionType}</p>
                          <div class="mt-3 space-y-1" style="font-size: ${baseSize * 0.9}px;">
                            <p style="color: ${config.text_color || defaultConfig.text_color};">ä½ çš„ç­”æ¡ˆï¼š<span class="font-semibold">${currentState.userAnswers[idx] || 'æœªä½œç­”'}</span></p>
                            <p style="color: ${config.accent_color || defaultConfig.accent_color};">æ­£ç¢ºç­”æ¡ˆï¼š<span class="font-semibold">${q.answer}</span></p>
                          </div>
                          <div class="mt-4 p-4 rounded-lg" style="background: ${config.primary_color || defaultConfig.primary_color}10;">
                            <p class="font-semibold mb-2" style="font-size: ${baseSize * 0.9}px; color: ${config.button_color || defaultConfig.button_color};">ğŸ“ è§£é¡Œéç¨‹ï¼š</p>
                            <pre class="whitespace-pre-wrap" style="font-size: ${baseSize * 0.85}px; color: ${config.text_color || defaultConfig.text_color}; font-family: ${customFont}, ${baseFontStack};">${q.solution}</pre>
                          </div>
                        </div>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
              
              <button id="restartBtn" class="w-full mt-8 px-6 py-4 rounded-lg font-bold text-white shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                      style="background: ${config.button_color || defaultConfig.button_color}; font-size: ${baseSize * 1.1}px; font-family: ${customFont}, ${baseFontStack};">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                </svg>
                ${config.restart_button_text || defaultConfig.restart_button_text}
              </button>
            </div>
          </div>
        `;
        
        document.getElementById('restartBtn').addEventListener('click', restart);
      }
    }

    function startQuiz() {
      const grade = document.getElementById('grade').value;
      const classNumber = document.getElementById('classNumber').value;
      const seatNumber = document.getElementById('seatNumber').value;
      
      if (!grade || !classNumber || !seatNumber) {
        return;
      }
      
      if (grade !== '5' && grade !== '6') {
        return;
      }
      
      currentState.grade = grade;
      currentState.classNumber = classNumber;
      currentState.seatNumber = seatNumber;
      currentState.stage = 'quiz';
      currentState.currentQuestionIndex = 0;
      currentState.userAnswers = [];
      
      render();
    }

    function submitAnswer() {
      const answer = document.getElementById('answerInput').value;
      currentState.userAnswers.push(answer);
      
      if (currentState.currentQuestionIndex < 5) {
        currentState.currentQuestionIndex++;
        render();
      } else {
        currentState.stage = 'results';
        render();
      }
    }

    function restart() {
      currentState = {
        stage: 'input',
        grade: '',
        classNumber: '',
        seatNumber: '',
        currentQuestionIndex: 0,
        userAnswers: [],
        dailyQuestions: generateDailyQuestions(getTodayDate()),
        todayDate: getTodayDate()
      };
      render();
    }

    async function initializeApp() {
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            render();
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  config.primary_color = value;
                  window.elementSdk.setConfig({ primary_color: value });
                }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => {
                  config.secondary_color = value;
                  window.elementSdk.setConfig({ secondary_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.button_color || defaultConfig.button_color,
                set: (value) => {
                  config.button_color = value;
                  window.elementSdk.setConfig({ button_color: value });
                }
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  config.accent_color = value;
                  window.elementSdk.setConfig({ accent_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["quiz_title", config.quiz_title || defaultConfig.quiz_title],
            ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
            ["start_button_text", config.start_button_text || defaultConfig.start_button_text],
            ["submit_button_text", config.submit_button_text || defaultConfig.submit_button_text],
            ["restart_button_text", config.restart_button_text || defaultConfig.restart_button_text]
          ])
        });
      }

      currentState.todayDate = getTodayDate();
      currentState.dailyQuestions = generateDailyQuestions(currentState.todayDate);
      
      render();
    }

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a5e0f3c86368f0f',t:'MTc2NDM3Njg4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>